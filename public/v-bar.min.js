var VBar=function(t){"use strict";function i(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.animatePercent=100,this.curentAnimatePercent=0,this.animation=!0}var e,n,s;return e=t,s=[{key:"init",value:function(i){var e=new t;return e._init(i),e}}],(n=[{key:"_init",value:function(t){if(!t)throw Error("container node is empty");this.canvas=document.createElement("canvas"),this.width=t.offsetWidth,this.height=t.offsetHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),t.appendChild(this.canvas)}},{key:"_initLayout",value:function(){this.marginTop=this.options.grid&&this.options.grid.top||50,this.marginRight=this.options.grid&&this.options.grid.right||50,this.marginBottom=this.options.grid&&this.options.grid.bottom||50,this.marginLeft=this.options.grid&&this.options.grid.left||50,this.innerWidth=this.width-this.marginLeft-this.marginRight,this.innerHeight=this.height-this.marginTop-this.marginBottom,this.x0=this.marginLeft,this.y0=this.width-this.marginBottom,this.legendH=this.marginTop,this.xGap=this.innerWidth/(this.options.xAxis.data.length+1),this.maxY=null,this.lastSeriesPosition=[]}},{key:"setOptions",value:function(t){if(!t)throw Error("options is undefined or null");this.options=JSON.parse(JSON.stringify(t)),this.animation=this.options.animation,this.curentAnimatePercent=0,this._initLayout(),this.render(this.options)}},{key:"render",value:function(t){this.clear(0,0,this.width,this.height),this.xAxis(this.ctx,t.xAxis,this.x0,this.y0,this.innerWidth),this.yAxios(this.ctx,t.yAxis,this.x0,this.y0,this.marginTop,this.innerHeight),this.legend(this.ctx,t.legend,this.width,this.legendH),this.serieses(this.ctx,t.series,this.x0,this.y0,t.xAxis,this.xGap,this.innerHeight)}},{key:"legend",value:function(t,i,e,n){for(var s=0,o=0;o<i.length;o++)s+=i[o].name.split("").length*parseInt(i[o].fontSize)+3*i[o].width;i.forEach((function(o,a){var r=(e+s)/2-(a+1)*(s/i.length),h=(n-parseInt(o.fontSize))/2;t.textBaseline="top",t.textAlign="start",t.fillStyle=o.background,t.fillRect(r,h,o.width,o.height),t.fillText(o.name,r+2*o.width,o.y)}))}},{key:"xAxis",value:function(t,i,e,n,s){t.beginPath();var o=i.data.length,a=s/(o+1);t.moveTo(e,n),t.lineTo(e+s,n),t.lineWidth=1,t.strokeStyle=i.color,t.stroke(),t.closePath(),t.fillStyle=i.color;for(var r=0;r<o;r++){var h=a*(r+1)+e;t.fillText(i.data[r],h,n+20),t.moveTo(h,n),t.lineTo(h,n+i.splitWidth),t.stroke()}}},{key:"yAxios",value:function(t,i,e,n,s,o){t.beginPath(),t.moveTo(e,n),t.lineTo(e,s),t.stroke();for(var a=Math.ceil(i.max/i.interval),r=0,h=[];r<a;)0===r?h.push(i.min):h.push(i.min+i.interval*r),r++;this.maxY=Math.max.apply(Math,h);for(var l=o/(h.length-1),c=0;c<h.length;c++){var d=n-l*c;if(d<s)break;t.font=i.fontSize+"px "+i.fontFamily,t.textAlign="end",t.textBaseline="middle",t.fillStyle=i.color,t.fillText(h[c],e-10,d),t.moveTo(e,d),0!=c&&t.lineTo(e-i.splitWidth,d),t.lineWidth=1,t.strokeStyle=i.color||"red",t.stroke(),t.closePath()}}},{key:"getH",value:function(t,i,e){return this.lastSeriesPosition[e]?this.lastSeriesPosition[e]-i:t-i}},{key:"serieses",value:function(t,i,e,n,s,o,a){for(var r=0;r<i.length;r++)for(var h=i[0].width/2,l=0,c=0;c<i[r].data.length;c++){var d=i[r].data[c]/this.maxY,f=e+(c+1)*o-h;l=this.animation?Math.ceil(a*d*this.curentAnimatePercent/this.animatePercent):Math.ceil(a*d),this.ctx.fillStyle=i[r].background,this.drawRect(t,f,this.getH(n,l,c),i[r].width,l),this.lastSeriesPosition[c]=n-l}this.lastSeriesPosition=[],this.curentAnimatePercent<this.animatePercent&&this.animation?(this.curentAnimatePercent++,this.animator=requestAnimationFrame(function(){this.clear(this.marginLeft+1,this.marginTop,this.width-this.marginLeft-this.marginRight,this.height-this.marginBottom-this.marginTop),this.serieses(this.ctx,i,this.x0,this.y0,this.xAxis,this.xGap,this.innerHeight)}.bind(this))):cancelAnimationFrame(this.animator)}},{key:"drawRect",value:function(t,i,e,n,s,o){t.save(),t.beginPath(),t.rect(i,e,n,s),o&&t.isPointInPath(2*mousePosition.x,2*mousePosition.y)&&(t.fillStyle="green"),t.fill(),t.closePath(),t.restore()}},{key:"clear",value:function(t,i,e,n){this.ctx.clearRect(t,i,e,n)}}])&&i(e.prototype,n),s&&i(e,s),t}();function n(t,i,e,n,s,o,a,r,h,l){"boolean"!=typeof a&&(h=r,r=a,a=!1);const c="function"==typeof e?e.options:e;let d;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,s&&(c.functional=!0)),n&&(c._scopeId=n),o?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,h(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=d):i&&(d=a?function(t){i.call(this,l(t,this.$root.$options.shadowRoot))}:function(t){i.call(this,r(t))}),d)if(c.functional){const t=c.render;c.render=function(i,e){return d.call(e),t(i,e)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,d):[d]}return e}var s=n({render:function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"bar",staticClass:"v-bar"})},staticRenderFns:[]},void 0,{name:"VBar",methods:{setOptions:function(t){this.bar.setOptions(t)}},mounted:function(){var t=this;this.$nextTick((function(){t.bar=e.init(t.$refs.bar)}))}},"data-v-dfea00aa",!1,void 0,!1,void 0,void 0,void 0),o=[s],a=function(t){o.forEach((function(i){t.component(i.name,i)}))};return"undefined"!=typeof window&&window.Vue&&a(window.Vue),t.VBar=s,t.default=a,t}({});
